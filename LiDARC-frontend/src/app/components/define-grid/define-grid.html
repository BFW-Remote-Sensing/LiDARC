<h2 mat-dialog-title>AOI of Reference: {{ selectedItem.name }}</h2>

<mat-dialog-content class="content-container">

  <div class="form-section">
    <h3>Define Grid Boundaries</h3>


    <form (ngSubmit)="onDefine()">
      <div class="metadata-display">
        <mat-form-field appearance="fill" class="input-field">
          <mat-label>X Min</mat-label>
          <input matInput type="number" [(ngModel)]="xMin" (ngModelChange)="updatePreview()" name="minX" required [min]="selectedItem.minX" [max]="selectedItem.maxX">
        </mat-form-field>

        <mat-form-field appearance="fill" class="input-field">
          <mat-label>X Max</mat-label>
          <input matInput type="number" [(ngModel)]="xMax" (ngModelChange)="updatePreview()" name="maxX" required [min]="selectedItem.minX" [max]="selectedItem.maxX">
        </mat-form-field>

        <mat-form-field appearance="fill" class="input-field">
          <mat-label>Y Min</mat-label>
          <input matInput type="number" [(ngModel)]="yMin" (ngModelChange)="updatePreview()" name="minY" required [min]="selectedItem.minY" [max]="selectedItem.maxY">
        </mat-form-field>

        <mat-form-field appearance="fill" class="input-field">
          <mat-label>Y Max</mat-label>
          <input matInput type="number" [(ngModel)]="yMax" (ngModelChange)="updatePreview()" name="maxY" required [min]="selectedItem.minY" [max]="selectedItem.maxY">
        </mat-form-field>
      </div>

      <h3>Define New Cell Dimensions</h3>
      <div class="metadata-display">
        <mat-form-field appearance="fill" class="input-field-full">
          <mat-label>Cell X Dimension</mat-label>
          <input matInput type="number" [(ngModel)]="cellX" name="cellX" required min="1">
          <mat-hint>Define the cell's X dimension in meters</mat-hint>
        </mat-form-field>

        <mat-form-field appearance="fill" class="input-field-full">
          <mat-label>Cell Y Dimension</mat-label>
          <input matInput type="number" [(ngModel)]="cellY" name="cellY" required min="1">
          <mat-hint>Define the cell's Y dimension in meters</mat-hint>
        </mat-form-field>
      </div>
    </form>
  </div>

  <div class="map-section">
    <h3>AOI Preview</h3>
    <div id="map" [style.visibility]="currentZone ? 'visible' : 'hidden'"></div>

    <div *ngIf="!currentZone" class="map-placeholder">
      <p>Please select a Coordinate Zone to view the map.</p>
    </div>
  </div>

</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">Cancel</button>
  <button mat-raised-button color="primary"
          [disabled]="!currentZone || cellX === null || cellY === null || xMin === null || xMax === null || yMin === null || yMax === null || xMin >= xMax || yMin >= yMax || xMin < selectedItem.minX || xMax > selectedItem.maxX || yMin < selectedItem.minY || yMax > selectedItem.maxY"
          (click)="onDefine()">
    Define Grid
  </button>
</mat-dialog-actions>
