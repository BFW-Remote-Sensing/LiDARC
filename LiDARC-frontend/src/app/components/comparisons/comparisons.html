<div style="padding: 30px;">
    @if (loading()) {
    <div class="flex-center">
        <mat-spinner></mat-spinner>
    </div>
    }@else if (!loading() && dataSource.data.length === 0 && !errorMessage()) {
    <app-text-card type="info" message="No comparison found."></app-text-card>
    }
    @else if (errorMessage()) {
    <app-text-card type="error" message="{{ errorMessage() }}"></app-text-card>
    }
    @else {
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" style="width: 100%;">

        <!-- Name Column -->
        <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let element">{{ element.name }}</td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef>Status</th>
            <td mat-cell *matCellDef="let element" [ngClass]="{
      'status-ready': element.status === 'COMPLETED',
      'status-error': element.status === 'FAILED'
    }">
                <div style="display: flex; column-gap: 10px;">
                    <span>{{ element.status }}</span>
                    @if (element.status === 'PENDING')
                    {
                    <mat-progress-spinner diameter="20" mode="indeterminate"></mat-progress-spinner>
                    }
                </div>
            </td>
        </ng-container>

        <!-- Created At Column -->
        <ng-container matColumnDef="filesLength">
            <th mat-header-cell *matHeaderCellDef>Files</th>
            <td mat-cell *matCellDef="let element">{{ element.files.length }}</td>
        </ng-container>

        <!-- Highest Vegetation -->
        <ng-container matColumnDef="highestVegetation">
            <th mat-header-cell *matHeaderCellDef>H/V</th>
            <td mat-cell *matCellDef="let element">
                <mat-icon color="primary" *ngIf="element.needHighestVegetation">check</mat-icon>
                <mat-icon color="warn" *ngIf="!element.needHighestVegetation">close</mat-icon>
            </td>
        </ng-container>

        <!-- Outlier Detection -->
        <ng-container matColumnDef="outlierDetection">
            <th mat-header-cell *matHeaderCellDef>O/D</th>
            <td mat-cell *matCellDef="let element">
                <mat-icon color="primary" *ngIf="element.needOutlierDetection">check</mat-icon>
                <mat-icon color="warn" *ngIf="!element.needOutlierDetection">close</mat-icon>
            </td>
        </ng-container>

        <!-- Statistics Over Scenery -->
        <ng-container matColumnDef="statisticsOverScenery">
            <th mat-header-cell *matHeaderCellDef>SoS</th>
            <td mat-cell *matCellDef="let element">
                <mat-icon color="primary" *ngIf="element.needStatisticsOverScenery">check</mat-icon>
                <mat-icon color="warn" *ngIf="!element.needStatisticsOverScenery">close</mat-icon>
            </td>
        </ng-container>

        <!-- Density Check -->
        <ng-container matColumnDef="mostDifferences">
            <th mat-header-cell *matHeaderCellDef>M/D</th>
            <td mat-cell *matCellDef="let element">
                <mat-icon color="primary" *ngIf="element.needMostDifferences">check</mat-icon>
                <mat-icon color="warn" *ngIf="!element.needMostDifferences">close</mat-icon>
            </td>
        </ng-container>

        <!-- Report Link Column -->
        <ng-container matColumnDef="resultReportUrl">
            <th mat-header-cell *matHeaderCellDef>Latest Report</th>
            <td mat-cell *matCellDef="let element">
                <a *ngIf="element.latestReport" [href]="this.globals.backendUri + element.latestReport" target="_blank"
                    rel="noopener" download>
                    Open Report
                </a>

                <span style="margin-left: 30px" *ngIf="!element.latestReport">â€”</span>
            </td>
        </ng-container>

        <!-- Created At Column -->
        <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef>Created At</th>
            <td mat-cell *matCellDef="let element">{{ element.createdAt | date: 'medium' }}</td>
        </ng-container>

        <!-- Actions Column -->
        <!-- <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element" style="text-align: right">
                <a [routerLink]="['/comparisons', element.id]">
                    <button mat-icon-button matTooltip="View Details" matTooltipPosition="right">
                        <mat-icon>visibility</mat-icon>
                    </button>
                </a>
            </td>
        </ng-container> -->

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
    }
    <div [hidden]="loading() || errorMessage() || dataSource.data.length === 0" style="margin-top: 20px">
        <mat-paginator [pageSizeOptions]="[10, 20, 30]" showFirstLastButtons>
        </mat-paginator>
    </div>
</div>