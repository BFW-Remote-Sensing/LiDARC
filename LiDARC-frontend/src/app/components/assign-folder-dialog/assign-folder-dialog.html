<h2 mat-dialog-title>Assign Folder</h2>
<mat-dialog-content>
    @if (loadingFolders()) {
    <div class="spinner-container">
        <mat-spinner diameter="20" color="accent"></mat-spinner>
        <span>Loading folders...</span>
    </div>
    } @else {
    <form (ngSubmit)="onAssign()">
        <mat-form-field>
            <mat-label>Select folder</mat-label>
            <mat-select [(ngModel)]="selectedFolderId" name="selectedFolderId">
                <!-- Search input inside the dropdown -->
                <div style="padding: 8px;">
                    <mat-form-field appearance="outline" [hintLabel]="filteredFolders().length + ' folders found.'">
                        <input matInput placeholder="Type to filter..." (keydown)="$event.stopPropagation()"
                            (click)="$event.stopPropagation()" (keyup)="filterFolders($event.target.value)" />
                    </mat-form-field>
                </div>
                <!-- Filtered options -->
                @for (folder of filteredFolders(); track $index) {
                <mat-option [value]="folder.id">
                    {{ folder.name }}
                </mat-option>
                }
            </mat-select>
        </mat-form-field>
    </form>
    }
</mat-dialog-content>
<mat-dialog-actions>
    <div class="actions">
        <button mat-button (click)="onCancel()">Cancel</button>
        <button mat-raised-button color="primary" (click)="onAssign()" style="width: 180px;"
            [disabled]="loadingAssign() || !selectedFolderId()">
            @if (loadingAssign()) {
            <mat-spinner diameter="20" color="accent"></mat-spinner>
            } @else {
            Assign Folder
            }
        </button>
    </div>
</mat-dialog-actions>